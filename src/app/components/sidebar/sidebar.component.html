<!-- M3 Enhanced Sidebar Navigation (ISC Portal Structure) -->
<nav class="sidebar-nav" role="navigation" aria-label="Main navigation">
  <mat-nav-list>
    <ng-container *ngFor="let item of navItems">
      <!-- Parent Item (with or without children) -->
      <mat-list-item
        *ngIf="!item.children"
        [routerLink]="item.route"
        routerLinkActive="active-nav-item"
        [attr.aria-label]="item.label"
        class="nav-item">
        <mat-icon matListItemIcon
                  [style.color]="'var(--md-sys-color-on-surface-variant)'">
          {{ item.icon }}
        </mat-icon>
        <span matListItemTitle
              class="md3-label-large"
              [style.color]="'var(--md-sys-color-on-surface)'">
          {{ item.label }}
        </span>
      </mat-list-item>

      <!-- Expandable Section -->
      <div *ngIf="item.children" class="expandable-section">
        <mat-list-item
          (click)="toggleSection(item)"
          class="nav-item parent-item"
          [attr.aria-label]="item.label"
          [attr.aria-expanded]="item.expanded">
          <mat-icon matListItemIcon
                    [style.color]="'var(--md-sys-color-on-surface-variant)'">
            {{ item.icon }}
          </mat-icon>
          <span matListItemTitle
                class="md3-label-large"
                [style.color]="'var(--md-sys-color-on-surface)'">
            {{ item.label }}
          </span>
          <mat-icon matListItemMeta
                    class="expand-icon"
                    [style.color]="'var(--md-sys-color-on-surface-variant)'">
            {{ item.expanded ? 'expand_less' : 'expand_more' }}
          </mat-icon>
        </mat-list-item>

        <!-- Children (shown when expanded) -->
        <div class="submenu" *ngIf="item.expanded">
          <mat-list-item
            *ngFor="let child of item.children"
            [routerLink]="child.route"
            routerLinkActive="active-nav-item"
            [attr.aria-label]="child.label"
            class="nav-item child-item">
            <mat-icon matListItemIcon
                      class="child-icon"
                      [style.color]="'var(--md-sys-color-on-surface-variant)'">
              {{ child.icon }}
            </mat-icon>
            <span matListItemTitle
                  class="md3-label-medium"
                  [style.color]="'var(--md-sys-color-on-surface)'">
              {{ child.label }}
            </span>
          </mat-list-item>
        </div>
      </div>
    </ng-container>
  </mat-nav-list>
</nav>
